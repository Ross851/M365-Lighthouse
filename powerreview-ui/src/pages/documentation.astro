---
import Layout from '../layouts/Layout.astro';
---

<Layout title="Documentation - PowerReview">
	<main>
		<div class="docs-container">
			<aside class="docs-sidebar">
				<h2>Documentation</h2>
				<nav>
					<ul>
						<li><a href="#getting-started">Getting Started</a></li>
						<li><a href="#installation">Installation</a></li>
						<li><a href="#authentication">Authentication</a></li>
						<li><a href="#assessments">Running Assessments</a></li>
						<li><a href="#reports">Understanding Reports</a></li>
						<li><a href="#api">API Reference</a></li>
						<li><a href="#troubleshooting">Troubleshooting</a></li>
					</ul>
				</nav>
			</aside>
			
			<div class="docs-content">
				<section id="getting-started">
					<h1>PowerReview Documentation</h1>
					<p class="lead">Welcome to PowerReview, the comprehensive security assessment platform for Microsoft 365, Azure, and DevOps environments.</p>
					
					<div class="alert alert-info">
						<strong>Version 2.1.0</strong> - Now with AI-powered assessments and executive reporting!
					</div>
				</section>

				<section id="installation">
					<h2>Installation</h2>
					<h3>Prerequisites</h3>
					<ul>
						<li>PowerShell 7.0 or higher</li>
						<li>Azure AD Global Administrator or Security Administrator role</li>
						<li>Microsoft 365 E3/E5 or equivalent licenses</li>
						<li>Node.js 18+ (for web UI)</li>
					</ul>

					<h3>Quick Start</h3>
					<pre><code class="language-bash"># Clone the repository
git clone https://github.com/Ross851/M365-Lighthouse.git
cd M365-Lighthouse

# Install PowerShell modules
PowerShell -File Install-PowerReview.ps1

# Start the web UI
cd powerreview-ui
npm install
npm run dev</code></pre>
				</section>

				<section id="authentication">
					<h2>Authentication</h2>
					<h3>Web UI Login</h3>
					<p>Access the web interface and log in with your credentials:</p>
					<ul>
						<li>Default URL: http://localhost:4321</li>
						<li>Demo credentials: demo@powerreview.com / demo</li>
					</ul>

					<h3>PowerShell Authentication</h3>
					<p>PowerReview uses modern authentication to connect to your Microsoft 365 tenant:</p>
					<pre><code class="language-powershell"># Connect to Microsoft 365
Connect-AzureAD
Connect-ExchangeOnline
Connect-MicrosoftTeams

# Or use the all-in-one connection
Connect-AzureAD</code></pre>
				</section>

				<section id="assessments">
					<h2>Running Assessments</h2>
					<h3>Web Interface</h3>
					<ol>
						<li>Navigate to the Assessment page</li>
						<li>Select the services to assess</li>
						<li>Configure assessment depth</li>
						<li>Start the assessment</li>
						<li>Monitor real-time progress</li>
						<li>View results in the dashboard</li>
					</ol>

					<h3>PowerShell Direct</h3>
					<pre><code class="language-powershell"># Run comprehensive assessment
PowerShell -File Start-PowerReview-Enhanced.ps1

# Run specific module
PowerShell -File Start-PowerReview-Enhanced.ps1 -Module "AzureAD"</code></pre>

					<h3>AI-Powered Assessment</h3>
					<p>Use the AI Assistant for natural language queries:</p>
					<ul>
						<li>"Check our Exchange security settings"</li>
						<li>"Find users without MFA enabled"</li>
						<li>"Analyze SharePoint external sharing risks"</li>
					</ul>
				</section>

				<section id="reports">
					<h2>Understanding Reports</h2>
					<h3>Executive Dashboard</h3>
					<p>The executive dashboard provides:</p>
					<ul>
						<li>Risk score visualization</li>
						<li>Critical findings summary</li>
						<li>Business impact analysis</li>
						<li>Tiered recommendations (Gold/Silver/Bronze)</li>
						<li>Evidence-based reporting</li>
					</ul>

					<h3>Technical Reports</h3>
					<p>Detailed technical reports include:</p>
					<ul>
						<li>Configuration analysis</li>
						<li>Security baseline comparisons</li>
						<li>PowerShell remediation scripts</li>
						<li>Step-by-step fix instructions</li>
					</ul>

					<h3>Compliance Mapping</h3>
					<p>Automatic mapping to compliance frameworks:</p>
					<ul>
						<li>GDPR</li>
						<li>HIPAA</li>
						<li>SOC2</li>
						<li>ISO 27001</li>
						<li>NIST</li>
					</ul>
				</section>

				<section id="api">
					<h2>API Reference</h2>
					<p>PowerReview provides a RESTful API for automation and integration.</p>

					<h3>Authentication</h3>
					<pre><code class="language-http">POST /api/auth/login
Content-Type: application/json

&#123;
  "email": "user@example.com",
  "password": "password"
&#125;</code></pre>

					<h3>Start Assessment</h3>
					<pre><code class="language-http">POST /api/assessment/start
Authorization: Bearer YOUR_TOKEN
Content-Type: application/json

&#123;
  "modules": ["azuread", "exchange", "sharepoint"],
  "depth": "comprehensive",
  "outputFormat": "json"
&#125;</code></pre>

					<h3>Get Results</h3>
					<pre><code class="language-http">GET /api/results/[sessionId]
Authorization: Bearer YOUR_TOKEN</code></pre>

					<h3>Generate Report</h3>
					<pre><code class="language-http">POST /api/reports/executive
Authorization: Bearer YOUR_TOKEN
Content-Type: application/json

&#123;
  "format": "pdf",
  "includeEvidence": true,
  "clientName": "Organization Name"
&#125;</code></pre>
				</section>

				<section id="troubleshooting">
					<h2>Troubleshooting</h2>
					<h3>Common Issues</h3>
					<h4>Authentication Failed</h4>
					<p>If you encounter authentication issues:</p>
					<ul>
						<li>Ensure you have the required admin roles</li>
						<li>Check if MFA is configured correctly</li>
						<li>Verify tenant ID and credentials</li>
					</ul>

					<h4>Module Not Found</h4>
					<p>Install missing PowerShell modules:</p>
					<pre><code class="language-powershell"># Install missing modules
Install-Module -Name ExchangeOnlineManagement -Force
Install-Module -Name Microsoft.Graph -Force
Install-Module -Name Microsoft.Online.SharePoint.PowerShell -Force</code></pre>

					<h4>Performance Issues</h4>
					<p>For large tenants:</p>
					<ul>
						<li>Use the "Quick" assessment depth first</li>
						<li>Run assessments during off-peak hours</li>
						<li>Consider splitting assessments by service</li>
					</ul>

					<h3>Getting Help</h3>
					<p>For additional support:</p>
					<ul>
						<li>Check the <a href="https://github.com/Ross851/M365-Lighthouse">GitHub repository</a></li>
						<li>Review the error logs in Output/SessionId/</li>
						<li>Enable debug mode for detailed output</li>
					</ul>
				</section>
			</div>
		</div>
	</main>
</Layout>

<style>
	main {
		min-height: calc(100vh - 200px);
	}

	.docs-container {
		display: flex;
		max-width: 1400px;
		margin: 0 auto;
		gap: 2rem;
		padding: 2rem;
	}

	.docs-sidebar {
		width: 250px;
		position: sticky;
		top: 80px;
		height: fit-content;
		background: white;
		border-radius: 12px;
		padding: 2rem;
		box-shadow: var(--shadow-md);
	}

	.docs-sidebar h2 {
		font-size: 1.25rem;
		margin-bottom: 1rem;
		color: var(--color-dark);
	}

	.docs-sidebar nav ul {
		list-style: none;
		padding: 0;
		margin: 0;
	}

	.docs-sidebar nav li {
		margin-bottom: 0.5rem;
	}

	.docs-sidebar nav a {
		color: var(--color-gray);
		text-decoration: none;
		display: block;
		padding: 0.5rem 0.75rem;
		border-radius: 6px;
		transition: all 0.3s ease;
	}

	.docs-sidebar nav a:hover {
		background: var(--color-bg);
		color: var(--color-primary);
	}

	.docs-content {
		flex: 1;
		background: white;
		border-radius: 12px;
		padding: 3rem;
		box-shadow: var(--shadow-md);
	}

	.docs-content h1 {
		font-size: 2.5rem;
		margin-bottom: 1rem;
		color: var(--color-dark);
	}

	.docs-content h2 {
		font-size: 2rem;
		margin-top: 3rem;
		margin-bottom: 1rem;
		color: var(--color-dark);
		border-bottom: 2px solid var(--color-light-gray);
		padding-bottom: 0.5rem;
	}

	.docs-content h3 {
		font-size: 1.5rem;
		margin-top: 2rem;
		margin-bottom: 1rem;
		color: var(--color-dark);
	}

	.docs-content h4 {
		font-size: 1.25rem;
		margin-top: 1.5rem;
		margin-bottom: 0.75rem;
		color: var(--color-dark);
	}

	.lead {
		font-size: 1.25rem;
		color: var(--color-gray);
		margin-bottom: 2rem;
		line-height: 1.8;
	}

	.alert {
		padding: 1rem 1.5rem;
		border-radius: 8px;
		margin: 1.5rem 0;
	}

	.alert-info {
		background: #e0f2fe;
		color: #0369a1;
		border-left: 4px solid #0ea5e9;
	}

	pre {
		background: #1e293b;
		color: #e2e8f0;
		padding: 1rem;
		border-radius: 8px;
		overflow-x: auto;
		margin: 1rem 0;
	}

	code {
		font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
		font-size: 0.9rem;
		background: #f1f5f9;
		padding: 0.2rem 0.4rem;
		border-radius: 4px;
	}

	pre code {
		background: transparent;
		padding: 0;
	}

	table {
		width: 100%;
		border-collapse: collapse;
		margin: 1rem 0;
	}

	th, td {
		padding: 0.75rem;
		text-align: left;
		border-bottom: 1px solid var(--color-light-gray);
	}

	th {
		background: var(--color-bg);
		font-weight: 600;
		color: var(--color-dark);
	}

	ul, ol {
		margin: 1rem 0;
		padding-left: 2rem;
		line-height: 1.8;
	}

	li {
		margin-bottom: 0.5rem;
	}

	section {
		margin-bottom: 3rem;
	}

	a {
		color: var(--color-primary);
		text-decoration: none;
	}

	a:hover {
		text-decoration: underline;
	}

	@media (max-width: 768px) {
		.docs-container {
			flex-direction: column;
		}

		.docs-sidebar {
			width: 100%;
			position: static;
		}

		.docs-content {
			padding: 2rem;
		}
	}
</style>